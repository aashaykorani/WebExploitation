name: Running server

on: push    #runs at 11:30 UTC everyday

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      - name: checkout repo content
        uses: actions/checkout@v2 
      - name: Setup python
        uses: actions/setup-python@v2
      # - name: Trying python script
      #   uses: jannekem/run-python-script-action@v1
      #   with:
      #     script: |
      #       import os
      #       print("Directory contents:")
      #       for f in os.listdir():
      #           print(f)
        with:
          python-version: 3.8
      - name: Custom
        run: |
          cd GiftcardSite
          sudo python3 -m pip install Django
          sudo python3 -c 'import django'
          sudo python3 manage.py makemigrations LegacySite
          sudo python3 manage.py migrate
          sudo python3 manage.py runserver 80 &
          pid=$!
          sleep 10
          kill $pid
          echo "killed"

